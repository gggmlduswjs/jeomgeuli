# 완성형 한글 처리 구현

## 개요

완성형 한글(예: "가", "나")을 입력했을 때 두 셀 모두 표시하도록 구현되었습니다.

## 구현 내용

### 1. 백엔드 동작 (`backend/utils/braille_converter.py`)

완성형 한글 "가"는 다음과 같이 처리됩니다:

1. **12-dot 패턴이 있는 경우** (`ko_braille.json`에 정의됨):
   - "가": `[1,0,0,0,0,0,0,0,1,0,0,0]` → 2개 셀로 분할
     - 첫 번째 셀: `[1,0,0,0,0,0]` (ㄱ)
     - 두 번째 셀: `[0,0,1,0,0,0]` (ㅏ)

2. **12-dot 패턴이 없는 경우**:
   - 자음+모음으로 분해
   - "가" → "ㄱ" + "ㅏ" → 2개 셀 생성

### 2. 프론트엔드 동작 (`frontend/src/hooks/useBrailleSerial.ts`)

패턴 선택 전략이 다음과 같이 수정되었습니다:

```typescript
// 패턴 선택 전략:
// - 단일 문자 + 패턴 1개: 첫 번째 패턴만 전송 (단일 자음/모음)
// - 단일 문자 + 패턴 2개 이상: 모든 패턴 전송 (완성형 한글, 최대 3개)
// - 여러 문자: 최근 3개 패턴 전송 (3셀 버퍼 활용)
const patternsToSend = text.length === 1
  ? (patterns.length === 1 
    ? patterns.slice(0, 1)  // 단일 자음/모음: 첫 패턴만
    : patterns.slice(0, Math.min(patterns.length, 3)))  // 완성형 한글: 모든 패턴 (최대 3개)
  : patterns.slice(-3);    // 여러 문자: 최근 3개
```

### 3. 동작 예시

#### 예시 1: 단일 자음 "ㄱ"
- 입력: "ㄱ"
- 백엔드 변환: 1개 패턴 `[1,0,0,0,0,0]`
- 프론트엔드 전송: 1개 패턴만 전송
- 하드웨어 출력: 첫 번째 셀(오른쪽)에만 표시

#### 예시 2: 완성형 한글 "가"
- 입력: "가"
- 백엔드 변환: 2개 패턴
  - 첫 번째: `[1,0,0,0,0,0]` (ㄱ)
  - 두 번째: `[0,0,1,0,0,0]` (ㅏ)
- 프론트엔드 전송: 2개 패턴 모두 전송
- 하드웨어 출력: 
  - 첫 번째 셀(오른쪽): ㄱ
  - 두 번째 셀(중간): ㅏ

#### 예시 3: 여러 문자 "가나"
- 입력: "가나"
- 백엔드 변환: 4개 패턴 (가: 2개, 나: 2개)
- 프론트엔드 전송: 최근 3개 패턴 전송
- 하드웨어 출력: 최근 3개 셀에 표시

## 테스트 방법

1. **단일 자음/모음 테스트**:
   - "ㄱ", "ㄴ", "ㅏ", "ㅓ" 등 입력
   - 첫 번째 셀(오른쪽)에만 표시되는지 확인

2. **완성형 한글 테스트**:
   - "가", "나", "다" 등 입력
   - 두 셀 모두 표시되는지 확인
   - 첫 번째 셀(오른쪽): 자음
   - 두 번째 셀(중간): 모음

3. **여러 문자 테스트**:
   - "가나", "가나다" 등 입력
   - 최근 3개 셀에 표시되는지 확인

## 참고

- Arduino 펌웨어는 3셀 버퍼를 관리하며, 새 패턴이 들어오면 기존 패턴을 왼쪽으로 이동시킵니다.
- 패턴 전송 간 50ms delay가 있어 Arduino가 각 패턴을 안정적으로 처리할 수 있습니다.

